- name: Test clusters
  hosts: localhost
  tasks:

    - name: Get a list of clusters with hosts
      clusters:
        action: list
        with_hosts: true
      register: list_clusters

    - name: List clusters with hosts
      ansible.builtin.debug:
        var: list_clusters

    - name: Delete a cluster
      clusters:
        action: delete
        cluster_id: "{{ my_cluster_id }}"
      register: delete_cluster
      when: my_cluster_id is defined

    - name: List deleted cluster
      ansible.builtin.debug:
        var: delete_cluster
      when: delete_cluster is defined

    - name: Retrieve a cluster
      clusters:
        action: get
        cluster_id: "{{ my_cluster_id }}"
      register: cluster_details
      when: my_cluster_id is defined

    - name: List cluster details
      ansible.builtin.debug:
        var: get_cluster
      when: cluster_details is defined
...
